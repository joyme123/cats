<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <meta charset="utf-8">
    <title>关于context的设计</title>
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" />
    <link rel="stylesheet">

</head>

<body>
    <h1>关于context的设计</h1>
    <div>
        <h2>1.context概念简介</h2>
        <p>context是上下文的意思，在很多系统的设计中都会有context，在大多数系统中，context都是单例的，因为context中保存的是整个系统在运行中的一些共享变量。在cats的实现中，context不是单例的,这是因为cats是支持vhost的，也就是说会同时支持多个http服务的。因此context是一个http服务的上下文环境，对于一个http服务来说，它是单例的。</p>

        <h2>2.context是如何在一个http服务中传递的？</h2>
        <p>
            context在一个http服务初始化时被实例化，在http服务的Start()函数被调用时，会实例化这个http服务拥有的组件，在实例化组件时，注入context的指针，这样，http服务及其组件都拥有了context的引用，可以获取和修改context中的内容。
        </p>

        <h2>3.context的具体作用是什么？</h2>
        <p>
            Context其实是一个很简单的结构体，目前只包含一个map，主要作用是通过一个string设置和获取其对应的值。
            <pre>
                type Context struct {
                    KeyValue map[string]interface{}
                }
            </pre>
            具体作用有以下：
            <ul>
                <li>index组件、serveFile组件：index组件会向其中写入IndexFiles，也就是当url不指定具体资源时，默认加载的文件。index组件写入后，在之后的serveFile组件会根据这个值去寻找应该读取的文件</li>
                
            </ul>
        </p>

        <h2>4.一些要注意的点</h2>
        <p>
            1.server的context中，应该只保存server中共享的，如果是要在一个request请求中共享一些值，应该使用request中的context，这是针对于一次请求的上下文
        </p>
    </div>
    
</body>

</html>